---
title: "exercise_stats_intro"
author: "Gordana Popovic"
date: "23 January 2019"
output: html_document
---
### Main things to remember
* When thinking about how to analyse data, think: (1) what is the research question? (2) what are the main properties of the data?
*  When doing inferential statistics e.g., hypothesis tests, confidence intervals, there are assumptions: what are they? Are they reasonable for my study?
*  Be careful using and interpreting hypothesis tests and P-values
*  Do you know how to do a two-sample t-test on R, and interpret the output?



First read in some necessary libraries
```{r message=FALSE, warning=FALSE, paged.print=TRUE}
library(dplyr)
library(ggplot2)
library(reshape2)
rm(list = ls())
```


###Question 1
Consider the guinea pigs (smoking) example: Is there an association between the number of errors and treatment group (Control and Nicotine)?

a) Load the `smokePregnant.csv`.
```{r}
datsmoke <- read.csv("data/smokePregnant.csv")
```

b) What is the research question? Descriptive statistics or inference? Do we have a specific hypothesis to test or are we just estimating some parameter?

Inference; hypothesis test of whether there is difference in number of errors between two groups

c) What are the main properties of the data? One variable or two? Categorical or quantitative?

Two variables; one categorical and one quantitative

d) Produce a graph relevant to the original research question.
```{r}
datsmoke2 = melt(datsmoke, variable.name="treatment", value.name="errors")

boxplots_smoke2 = ggplot(datsmoke2, aes(treatment,errors)) + 
  geom_boxplot() + 
  ggtitle("Comparative boxplots of # of errors by treatment")
boxplots_smoke2
```

e) Left-skewed, right-skewed, symmetric?

Both are right skewed. Try transformation.

```{r}
boxplots_smoke2 +  scale_y_continuous(trans="log")
```

Log transforming looks Better

f) Use a two-sample $t$-test to see if there is evidence the # of errors (transformed if required) is associated with treatment group.
```{r}
t.test(log(datsmoke$Nicotine), log(datsmoke$Control), var.equal=T)
```

g) What is a plausible range of values for the mean difference  between treatments?

(0.2106 1.1224)

h) What did you assume in the above?  Check any assumptions you can, and comment on anything that could have been done in the study design to ensure assumptions were reasonable.

We assume

* Observations are independent
* random sample of GPs and and random allocation of treatments
* observations are normally distributed with same variance in both groups

```{r}
datsmoke2 %>% 
  group_by(treatment) %>%
  summarise(sd_of_log = sd(log(errors)))
```


###Question 2
\item Consider the bats example: 

*Kerry goes bat counting. She finds 65 female bats and 44 male bats in a colony. She would like to know if there is evidence of gender bias.*

a) Create a dataset from this information.
```{r}
batsex = data.frame(Sex = c("Male","Female"), count = c(44,65))
```

b) What is the research question? Descriptive statistics or inference? Do we have a specific hypothesis to test or are we just estimating some parameter?

Inference, with a specifc hypothesis to test (evidence of gender bias)

c) What are the main properties of the data? One variable or two? Categorical or quantitative?

One variable with two categories

d) Produce a graph relevant to the original research question.
```{r}
ggplot(batsex, aes(Sex,count)) + 
  geom_bar(stat = "identity") + 
  ylab("Frequency in Colony") + 
  ggtitle("Barplot of Bats in Colony by Sex")
```

e) Test if there is evidence of gender bias in the colony (consider `prop.test`)
```{r}
prop.test( t(batsex$count), correct = F)
```

f) What is a plausible range of values for the sex ratio in this colony?

(0.3163,0.4975)

g) What did you assume in the above?  What could have been done to ensure assumptions were reasonable?

Each bat has the same probability of being selected (independence); guaranteed by random sampling of bats